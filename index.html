<!DOCTYPE html>
<html>
  <head>
    <title>Report</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css"
         href="https://fonts.googleapis.com/css?family=Quantico">

    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 80%;
        margin: 5px;
        padding: 0;
        font-family: 'Quantico', sans-serif;
        background-color: #cefff5;
      }

      ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
      overflow: hidden;
  }

  li {
      float: left;
  }

  li a {
      display: block;
      color: white;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
  }

  /* Change the link color to #111 (black) on hover */
  li a:hover {
      background-color: #111;
  }

  .txt-field{
    width: 100%;
    height: 30px;
    font-size: 1.2em;
    display: block;
    margin: 5px;
  }

  /* dropdown */
#problem-type {
  display: inline-block;
}

#problem-location, #problem-description {
  width: 80%;
  max-width: 500px;
  font-family: 'Quantico', sans-serif;
}

#problem-description {
  height: 100px;
  text-align: top;
  line-height:
  font-family: 'Quantico', sans-serif;
}

#report-btn {
  font-size: 1.2em;
  width: 80%;
  height: 50px;
  max-width: 500px;
  background-color: #77c8ce;
  border: none;
  font-weight: bold;
  font-family: 'Quantico', sans-serif;
}

#estimated-time {
  font-family: 'Quantico', sans-serif;
}

#snackbar {
    visibility: hidden;
    min-width: 250px;
    margin-left: -125px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 2px;
    padding: 16px;
    position: fixed;
    z-index: 1;
    left: 50%;
    bottom: 30px;
    font-size: 17px;
}

#snackbar.show {
    visibility: visible;
    -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
    animation: fadein 0.5s, fadeout 0.5s 2.5s;
}

@-webkit-keyframes fadein {
    from {bottom: 0; opacity: 0;}
    to {bottom: 30px; opacity: 1;}
}

@keyframes fadein {
    from {bottom: 0; opacity: 0;}
    to {bottom: 30px; opacity: 1;}
}

@-webkit-keyframes fadeout {
    from {bottom: 30px; opacity: 1;}
    to {bottom: 0; opacity: 0;}
}

@keyframes fadeout {
    from {bottom: 30px; opacity: 1;}
    to {bottom: 0; opacity: 0;}
}

.icon-bar {
    width: 100%; /* Full-width */
    height: 40px;
    line-height: 40px;
    text-align: center;
    background-color: #555; /* Dark-grey background */
    overflow: auto; /* Overflow due to float */
}

.icon-bar a {
    float: left; /* Float links side by side */
    text-align: center; /* Center-align text */
    width: 20%; /* Equal width (5 icons with 20% width each = 100%)
    transition: all 0.3s ease; /* Add transition for hover effects */
    color: white; /* White text color */
    font-size: 20px; /* Increased font size */
    text-decoration: none;
}

.icon-bar a:hover {
    background-color: #000; /* Add a hover color */
}

.active {
    background-color: #77c8ce; /* Add an active/current color */
}

#expand {
  height: 0px;
  overflow: hidden;
  transition: height 0.5s;
}
section {
  padding: 0 20px;
}
#toggle:checked ~ #expand {
  height: 250px;
}
#toggle:checked ~ label::before {
  content: "-";
}

    </style>

  </head>
  <body>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!--<navbar style="position: fixed; z-index: 1;">
      <ul>
        <li><a href="#map">Map</a></li>
        <li><a href="#report">Report</a></li>
        <li><a href="#news">Profile</a></li>
        <li><a href="about.asp">Hub</a></li>
      </ul>
    </navbar>-->


    <div class="icon-bar" style="position: fixed; z-index: 1;">
      <a class="active" href="#map"><i class="fa fa-map"></i> Map</a>
      <a href="#report"><i class="fa fa-plus"></i> Report</a>
      <a href="#"><i class="fa fa-user"></i> Profile</a>
      <a href="#"><i class="fa fa-users"></i> Hub</a>
    </div>


    <div id="map"></div>

    <!--<div id="road-condition-map">
      <iframe src="https://www.google.com/maps/d/embed?mid=11mn922SZMwNs3OK30sIMiNvByt8" width="100%" height="480"></iframe>
    </div>-->

    <div id="report" align="center">
      <h2>REPORT</h2>
      <img alt="camera-icon" width="20%" src="https://cdn0.iconfinder.com/data/icons/flat-designed-circle-icon-2/1000/camera.png" onclick="window.open('pic')"/>
      <input class="txt-field" id="problem-location" placeholder="Current Location" type="text"</input>
      <form id=type>
        <input type="radio" name="problem-type" value="Fault" checked>Fault
        <input type="radio" name="problem-type" value="Attention">Attention
        <input type="radio" name="problem-type" value="Suggestion">Suggestion
      </form>
      <input id="toggle" type="checkbox">
      <label for="toggle">Add details</label>
      <div id="expand">
      <h3>DURATION</h3>
      <form id=time>
        <input type="radio" name="duration" value="Temporary" checked>Temporary
        <input type="radio" name="duration" value="Permanent">Permanent until
        <input type="date" data-date-inline-picker="true" id="estimated-time">
      </form>
      <h3>SEVERITY</h3>
      <form id=severity>
        <input type="radio" name="severity" value="Urgent" checked>Urgent
        <input type="radio" name="severity" value="not-urgent">Not urgent
      </form>
      <input class="txt-field" id="problem-description" type="text" placeholder="Description (optional)"></input>
    </div>
      <button id="report-btn" type="button" onclick="addProblem()" align="center">Send Report!</button>
    </div>

    <div id="snackbar">Thank You! You will be informed about the stage of your report soon.</div>

    <script>
      // Note: This example requires that you consent to location sharing when
      // prompted by your browser. If you see the error "The Geolocation service
      // failed.", it means you probably did not give permission for the browser to
      // locate you.
      var pos; //current pos 60.1700831,24.8056837
      var map;

      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 60.2045577, lng: 24.6568111},
          zoom: 15
        });
        var infoWindow = new google.maps.InfoWindow({map: map});
        /*var userMarker = new google.maps.Marker({
            position: myLatLng,
            map: map,
            icon: im
        });
        */

        // Try HTML5 geolocation.
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            infoWindow.setPosition(pos);
            infoWindow.setContent('You are here');

          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
          pos =
          {lat: 60.2045577, lng: 24.6568111
          };
        }

        var bikeLayer = new google.maps.BicyclingLayer();
        bikeLayer.setMap(map);

        var iconBase = 'http://maps.google.com/mapfiles/kml/pal3';
       var icons = {
         attention: {
           icon: iconBase + '/icon41.png'
         },
         suggestion: {
           icon: iconBase + '/icon35.png'
         },
         fault: {
           icon: iconBase + '/icon33.png'
         }
       };

       var features = [
         {
           position: new google.maps.LatLng(60.2045577, 24.6568111),
           type: 'fault'
         }, {
           position: new google.maps.LatLng(60.2045570, 24.6568111),
           type: 'suggestion'
         }, {
           position: new google.maps.LatLng(60.2045577, 24.6568116),
           type: 'suggestion'
         }, {
           position: new google.maps.LatLng(60.2045572, 24.6568115),
           type: 'attention'
         }, {
           position: new google.maps.LatLng(60.2045573, 24.6568119),
           type: 'attention'
         }, {
           position: new google.maps.LatLng(60.2045580, 24.6568111),
           type: 'attention'
         }, {
           position: new google.maps.LatLng(60.2045577, 24.6568120),
           type: 'fault'
         }

       ];

       // Create markers.
       features.forEach(function(feature) {
         var marker = new google.maps.Marker({
           position: feature.position,
           icon: icons[feature.type].icon,
           map: map
         });
       });
      }

      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'No location found, please turn GPS on' :
                              'Error: Your browser doesn\'t support geolocation.');
      }

      // Create marker for new problem
      function addProblem() {
        //add marker to the map
        var marker = new google.maps.Marker({
        position: pos,
        map: map,
        title: 'Hello World!'
      });
      marker.addListener('click', showReportInfo(marker));
      console.log(marker);
      console.log("problem added");
      showNotification("Thank You");
        //marker.addListener('click', toggleBounce);
      }


    function showNotification(message){
      var x = document.getElementById("snackbar")
      x.className = "show";
      setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }

    function showReportInfo(marker){
      var reportPosition = marker.position;
      var infoWindow = new google.maps.InfoWindow({map: map});
      infoWindow.setPosition(pos);
      infoWindow.setContent('Report content here');
    }

    function toggleBounce() {
      if (marker.getAnimation() !== null) {
        marker.setAnimation(null);
      } else {
        marker.setAnimation(google.maps.Animation.BOUNCE);
      }

    }

    function takePicture() {
      console.log("picture taken");
      window.open("Picture taken!");
    }

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBt6Fj_3whrrl1P6BCTW9ZhA9iHx7tsU8k&callback=initMap">
    </script>
  </body>
</html>
